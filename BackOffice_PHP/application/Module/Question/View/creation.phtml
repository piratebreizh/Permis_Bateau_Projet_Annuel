<h2>Création d'une question</h2>

<form method="post" id="form_question_creation" class="form-horizontal" action="/question/saveQuestion"
      enctype="multipart/form-data">
    <input type="hidden" name="id_examen" id="id_examen" value="<?php echo $this->id_examen; ?>"/>
    <!-- Enonce -->
    <div class="form-group">
        <label class="col-sm-2 control-label" for="question_enonce">Enoncé de la question : </label>

        <div class="col-sm-10">
            <textarea class="form-control" name="question_enonce" id="question_enonce"
                      placeholder="Enoncé de la question" required></textarea>

            <div class="help-block with-errors"></div>
        </div>
    </div>
    <!-- Réponse A -->
    <div class="form-group">
        <label class="col-sm-2 control-label" for="enonce_A">Réponse A : </label>

        <div class="input-group col-sm-10">
            <span class="input-group-addon">
                <input name="is_correct_A" id="is_correct_A" type="checkbox" data-checkbox="true"/>
            </span>
            <input class="form-control" name="enonce_A" id="enonce_A" placeholder="Réponse A" data-nb_responses="true"/>
        </div>
    </div>
    <!-- Réponse B -->
    <div class="form-group">
        <label class="col-sm-2 control-label" for="enonce_B">Réponse B : </label>

        <div class="input-group col-sm-10">
            <span class="input-group-addon">
                <input name="is_correct_B" id="is_correct_B" type="checkbox" data-checkbox="true"/>
            </span>
            <input class="form-control" name="enonce_B" id="enonce_B" placeholder="Réponse B" data-nb_responses="true"/>
        </div>
    </div>
    <!-- Réponse C -->
    <div class="form-group">
        <label class="col-sm-2 control-label" for="enonce_C">Réponse C : </label>

        <div class="input-group col-sm-10">
            <span class="input-group-addon">
                <input name="is_correct_C" id="is_correct_C" type="checkbox" data-checkbox="true"/>
            </span>
            <input class="form-control" name="enonce_C" id="enonce_C" placeholder="Réponse C" data-nb_responses="true"/>
        </div>
    </div>
    <!-- Réponse D -->
    <div class="form-group">
        <label class="col-sm-2 control-label" for="enonce_D">Réponse D : </label>

        <div class="input-group col-sm-10">
            <span class="input-group-addon">
                <input name="is_correct_D" id="is_correct_D" type="checkbox" data-checkbox="true"/>
            </span>
            <input class="form-control" name="enonce_D" id="enonce_D" placeholder="Réponse D" data-nb_responses="true"/>
        </div>
    </div>
    <!-- Image -->
    <div class="form-group">
        <label class="col-sm-2 control-label">Image : </label>

        <div class="input-group col-sm-10">
            <input class="form-control" name="image" id="image" type="file"/>
        </div>
    </div>
    <div class="has-error">
        <div class="col-sm-10 help-block with-errors" id="error_checkbox" style="display: none;"><ul class="list-unstyled"><li>Veuillez sélectionner au moins une réponse</li></ul></div>
        <div class="col-sm-10 help-block with-errors" id="error_nb_responses" style="display: none;"><ul class="list-unstyled"><li>Veuillez renseigner 2 ou 4 réponses</li></ul></div>
    </div>
    <div class="clearfix"></div>
    <button type="submit" id="btn_submit_form" class="btn btn-default">Valider</button>
</form>

<script>
    var validator = $('#form_question_creation').validator({
        'custom': {
            checkbox: function ($el) {
                var is_correct_A = $('#is_correct_A')[0].checked;
                var is_correct_B = $('#is_correct_B')[0].checked;
                var is_correct_C = $('#is_correct_C')[0].checked;
                var is_correct_D = $('#is_correct_D')[0].checked;
                if (
                    (is_correct_A == false && is_correct_B == false && is_correct_C == false && is_correct_D == false)
                || (isTwoResponses() && ((is_correct_A == false && is_correct_B == false) || is_correct_C == true && is_correct_D == true))
                ) {
                    $('#error_checkbox').show();
                    return false;
                }
                else {
                    $('#error_checkbox').hide();
                    return true;
                }
            },
            nb_responses: function($el){
                if(!isTwoResponses() && !isFourResponses()){
                    $('#error_nb_responses').show();
                    return false;
                }else{
                    $('#error_nb_responses').hide();
                    return true;
                }
            }
        },
        'errors' : {
            checkbox : "Veuillez sélectionner au moins une réponse.",
            nb_responses : "Veuillez renseigner 2 ou 4 réponses."
        }
    });

    function isTwoResponses() {
        var $enonce_A = $('#enonce_A');
        var $enonce_B = $('#enonce_B');
        var $enonce_C = $('#enonce_C');
        var $enonce_D = $('#enonce_D');
        return $enonce_A.val() != ""
            && $enonce_B.val() != ""
            && $enonce_C.val() == ""
            && $enonce_D.val() == "";
    }

    function isNbResponsesIncorrect() {
        var $enonce_C = $('#enonce_C');
        var $enonce_D = $('#enonce_D');
        return

        ($enonce_C.val() != "" && $enonce_D.val() == "") || ($enonce_C.val() == "" && $enonce_D.val() != "") ;
    }

    function isFourResponses() {
        var $enonce_A = $('#enonce_A');
        var $enonce_B = $('#enonce_B');
        var $enonce_C = $('#enonce_C');
        var $enonce_D = $('#enonce_D');
        return $enonce_A.val() != ""
            && $enonce_B.val() != ""
            && $enonce_C.val() != ""
            && $enonce_D.val() != "";
    }
</script>